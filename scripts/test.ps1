$token = "eyJ0eXAiOiJKV1QiLCJub25jZSI6InFFX3ZJZGtQb1ZCUmFWVlphbll6RHA4YXV1dV8tT3plRDlneml2QWQ4MWciLCJhbGciOiJSUzI1NiIsIng1dCI6IlBjWDk4R1g0MjBUMVg2c0JEa3poUW1xZ3dNVSIsImtpZCI6IlBjWDk4R1g0MjBUMVg2c0JEa3poUW1xZ3dNVSJ9.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9iZmIxZTFkZi01ZTE2LTQzMmMtYmM0Yy03YWRhMTYyMzlhMzIvIiwiaWF0IjoxNzY5NjE4MzUyLCJuYmYiOjE3Njk2MTgzNTIsImV4cCI6MTc2OTYyMjI3NywiYWNjdCI6MCwiYWNyIjoiMSIsImFpbyI6IkFVUUF1LzhiQUFBQU9pdWpUK05SRHp0SWxtVHVEYlFqWTZoWnNHWkxxSVVqbDV3SzFEUks0R3FEQVZDdGpEdjF2TFZ4bjlCeDIzTEcvNjhZbE5ZT2dsaGpud09LbkwwZXB3PT0iLCJhbXIiOlsicHdkIiwicnNhIl0sImFwcF9kaXNwbGF5bmFtZSI6Ik1pY3Jvc29mdCBBenVyZSBDTEkiLCJhcHBpZCI6IjA0YjA3Nzk1LThkZGItNDYxYS1iYmVlLTAyZjllMWJmN2I0NiIsImFwcGlkYWNyIjoiMCIsImRldmljZWlkIjoiNTllMjRjNDAtY2Y5Mi00MmRiLWFkOGMtZWMwMGFkNjk0YmU4IiwiZmFtaWx5X25hbWUiOiJCYXJnaHVzIiwiZ2l2ZW5fbmFtZSI6IkJyZW5kYW4iLCJpZHR5cCI6InVzZXIiLCJpcGFkZHIiOiIyMDAxOjFjMDI6MzYwYTozNzAwOjU4NDY6ZTNhYzo3NzQ3OmI5OGIiLCJuYW1lIjoiQnJlbmRhbiBCYXJnaHVzIiwib2lkIjoiMWM0ZDdhZGQtODlhZS00MThhLTg0NzItOTI4ZDUxMjBmNzViIiwicGxhdGYiOiIzIiwicHVpZCI6IjEwMDMyMDA0OUUxRUMzQzkiLCJwd2RfdXJsIjoiaHR0cHM6Ly9nby5taWNyb3NvZnQuY29tL2Z3bGluay8_bGlua2lkPTIyMjQxOTgiLCJyaCI6IjEuQWE4QTMtR3h2eFplTEVPOFRIcmFGaU9hTWdNQUFBQUFBQUFBd0FBQUFBQUFBQUN2QVB1dkFBLiIsInNjcCI6IkFwcGxpY2F0aW9uLlJlYWRXcml0ZS5BbGwgQXBwUm9sZUFzc2lnbm1lbnQuUmVhZFdyaXRlLkFsbCBBdWRpdExvZy5SZWFkLkFsbCBEZWxlZ2F0ZWRQZXJtaXNzaW9uR3JhbnQuUmVhZFdyaXRlLkFsbCBEaXJlY3RvcnkuQWNjZXNzQXNVc2VyLkFsbCBlbWFpbCBHcm91cC5SZWFkV3JpdGUuQWxsIG9wZW5pZCBwcm9maWxlIFVzZXIuUmVhZC5BbGwgVXNlci5SZWFkV3JpdGUuQWxsIiwic2lkIjoiMDA1MDcxZDktMTZhMS1kMzg3LTNiMjQtMzkyOWYyOWMxYzVhIiwic2lnbmluX3N0YXRlIjpbImttc2kiXSwic3ViIjoiUnFTX21pMEFieUxZem5IbFJaMFlwY1hRSkFPald0eTNiOE5VUVdoY1o4NCIsInRlbmFudF9yZWdpb25fc2NvcGUiOiJFVSIsInRpZCI6ImJmYjFlMWRmLTVlMTYtNDMyYy1iYzRjLTdhZGExNjIzOWEzMiIsInVuaXF1ZV9uYW1lIjoiYnJlbmRhbi5iYXJnaHVzQHpvcmdiaWpqb3UuY29tIiwidXBuIjoiYnJlbmRhbi5iYXJnaHVzQHpvcmdiaWpqb3UuY29tIiwidXRpIjoiaUdRbENxMUJEVUdFZlpWU0VmdWpBQSIsInZlciI6IjEuMCIsIndpZHMiOlsiYjc5ZmJmNGQtM2VmOS00Njg5LTgxNDMtNzZiMTk0ZTg1NTA5Il0sInhtc19hY3RfZmN0IjoiNSAzIiwieG1zX2NjIjpbIkNQMSJdLCJ4bXNfZnRkIjoibkdMU1NfTjJLSDhqYzRyV2lKbjExRDF4U0xkZ3ZXMGUtNGEzYkJiT0JWc0JjM2RsWkdWdVl5MWtjMjF6IiwieG1zX2lkcmVsIjoiMSAzMiIsInhtc19zc20iOiIxIiwieG1zX3N0Ijp7InN1YiI6InFOa0dJT3FrTi1DVkF4czg5STdvdlBFb1I5Q2J1bk5EVjAwZGJLTFMxblUifSwieG1zX3N1Yl9mY3QiOiIzIDE0IiwieG1zX3RjZHQiOjE2OTk0MzA2MTIsInhtc190ZGJyIjoiRVUiLCJ4bXNfdG50X2ZjdCI6IjMgOCJ9.gl7pu93OcqlCUuer_kkL32Ni3rxcdkY2KeUdN-hAPYoI8GyHNKqkFkMWmC3kPnLk1yxNlnYAGlENYJ6ww1OiqFtQutrene_MHq8bMX5pAueF9lDjNHblYL-dZWCfYH6HqWrMTXVoJ9N_8l_QVUDZYVtqauwmpiiO2gXmTa-eWpm7RL8Fqt7aNccN28ANM73g36XX2_TvmnFSv6DKYjietDvWjn7ffxX7ihOdMa_x3j7MOOYMCXKTZ6eqFico5y_UH-Ier0sgX_ZgtG8oIN_urGc4b20QmMQIGFEWGAPCn6d1y7nNic4pLf1YjOM29e3HFa1fYkqVb72YFHNiPAwqPQ"
$userId = "d4f06c92-c9fe-45a8-8faf-60933bc9ea30"

Invoke-WebRequest `
  -Method GET `
  -Uri "https://graph.microsoft.com/v1.0/users/$userId/photo/`$value" `
  -Headers @{ Authorization = "Bearer $token" } `
  -OutFile ".\photo.jpg"
